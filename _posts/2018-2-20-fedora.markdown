---
layout: post
title:  Fedora, CentOS, DKMS
category: linux 
---

* toc
{:toc}

# Fedora

Fedora作为主要的Linux发行版之一，我虽然用的不多，但实际上这却是我最早接触的Linux发行版。后来换用Ubuntu，很大的原因是因为：这是Google为Android选择的开发平台。

最近因为工作需要重新捡起了Fedora。但公司所用的版本太过古老，还是2009年的Fedora 12。所以想了一下，开始试用最新的Fedora 22(2015.2)。这里是使用过程中的一些操作笔记。

## 安装

https://getfedora.org/

这是官方的下载地址。这里我用的是Workstation版本。

Fedora 22的默认桌面是GNOME 3.16，这一版的外观借鉴了Mac OS X的一些设计，让人眼前一亮。

## 安装软件

Fedora 22使用dnf替代yum。因此安装基本gcc开发环境，可用如下命令：

`dnf install gcc kernel-devel patch bison flex subversion`

如果下载速度较慢的话，可以在/etc/dnf/dnf.conf最后添加：

`fastestmirror=true`

保存后，执行

```bash
$ sudo dnf clean all
$ sudo dnf makecache
```

此外，和Ubuntu一样，Fedora也有自己的网站可以查询软件包信息：

https://admin.fedoraproject.org/pkgdb/

## 共享文件夹

我用的是VirtualBox的虚拟环境，因此除了在VirtualBox中，设置共享文件夹之外，还需对Fedora进行如下操作：

1.添加用户到vboxsf中。

`usermod -a -G vboxsf <your user name>`

2.重启。（这一步必不可少，否则上面的配置不会生效。）

这样就可以在Fedora中浏览共享文件夹了。

# CentOS

## 关于repo设置

最近在数台PC上部署软件，系统都是CentOS 6。结果发现其中有一台机器无法使用yum安装软件。

解决办法：

1.进入/etc/yum.repos.d中删除CentOS6-Base.repo之外的所有文件。

2.`yum clean all`

第1步很重要，从事后情况来看，故障是由于某些之前的repo现在已经无法连接所致导致的。

## start-stop-daemon

start-stop-daemon是Ubuntu中用的比较多的工具，但是CentOS中并没有。由于start-stop-daemon在ubuntu的dpkg包中，和apt关系比较近，因此直接下载源码，也不是个好办法。

https://packagecloud.io/willgarcia/start-stop-daemon/install

上面的网页提供了一种办法。但是由于网络不好，中间步骤的文件有时需要手动下载才行。

## 关于epel

1.安装epel源

`yum install epel-release`

2.修改/etc/yum.repos.d/epel.repo

将mirrorlist中的https修改为http。否则，会报如下错误：

`Error: Cannot retrieve metalink for repository: epel`

## DNF

`yum install dnf`

这个似乎需要Cent OS 7以上，Cent OS 6反正是不行的。

## 关于VNC

1.安装

`yum install tightvnc-server`

这里虽然包名叫做tightvnc-server，但实际上用的是tigervnc-server，因此以后者为包名来安装也是可以的。

2.初次启动，设置密码

`vncpasswd`

3.配置分辨率、端口

修改/etc/sysconfig/vncservers：

```bash
## Single User ##
VNCSERVERS="1:<user name>"
VNCSERVERARGS[1]="-geometry 1280x1024"
```

默认端口一般是5900~5904。这里的数组下标表明它使用的端口是5901。

4.启动服务

`/etc/init.d/vncserver start`

参考：

http://www.tecmint.com/install-tightvnc-remote-desktop/

Install TightVNC Server in RHEL/CentOS and Fedora to Access Remote Desktops

# DKMS

我们都知道，如果要使用没有集成到内核之中的Linux驱动程序需要手动编译。而Linux模块和内核是有依赖关系的，如果遇到因为发行版更新造成的内核版本的变动，之前编译的模块是无法继续使用的，我们只能手动再编译一遍。

DKMS（Dynamic Kernel Module Support）可以帮我们维护内核外的这些驱动程序，在内核版本变动之后，可以自动重新生成新的模块。

示例：

https://github.com/antkillerfarm/antkillerfarm_crazy/tree/master/linux_driver/dkms

DKMS管理的驱动的安装路径：`/var/lib/dkms`

2022.7

8年过去了，内核的编译方式略有改动，原来需要两个makefile，现在一个就够了。

Q：`ifneq ($(KERNELRELEASE),)`会使makefile执行两次，为什么？

A：第一次读取makefile时，因为ifneq的存在，先执行了`make -C $(KDIR) M=$(PWD`。

`-C $(KDIR)`：指明跳转到内核源码目录下读取那里的Makefile

`M=$(PWD)`：表明返回到当前目录继续读入、执行当前的Makefile

从内核Makefile返回时，`KERNELRELEASE`已被定义，kbuild也被启动，make将继续读取else的内容。

参考：

https://blog.csdn.net/fouweng/article/details/53435602

DKMS简介

https://codeleading.com/article/93045146650/

Makefile中($(KERNELRELEASE),)执行分析

# 俄乌战争+

俄国补贴给所有顿、卢军的人月薪25,000卢布（约2500人民币）。在打烂的顿巴斯，这往往是仅有的工作。这些人为钱当兵后，被嘲笑为“二万五” (类似中文语境中的二百五)。

至于那些基层的小斯特列科夫，就老老实实接受阿尔巴特精英指挥，去啃东部碉堡群吧。打死乌军除外患，自己牺牲除内乱。在阿尔巴特看来，这些形形色色的魔怔人，最好全都战死东乌，省的战后还要给他们留位置。

阿尔巴特街(Arbat Street)是莫斯科市中心的一条著名步行街。

4月，顿涅茨克某著名钢琴家在马里乌波尔附近的作战中丧生。他是怎么从军的？

“爱乐乐团全部上当了！他们听说是来拍个节目就回家，结果全部被拉走！”

“我们也一样，我们也被骗了，顿巴斯的歌剧团、马戏团都是”

“他不是志愿者！！！像所有的音乐家一样！”

https://zhuanlan.zhihu.com/p/510586867

Z战争和总动员（上）

https://zhuanlan.zhihu.com/p/510673824

Z战争和总动员（下）

https://zhuanlan.zhihu.com/p/497789494

“人人可当炮灰”50天以来，DNR许多居民一直躲避强制动员战争。这是其中一位的故事

---

苏联的工程师，声望和薪水双高，军事工程师就是王。但现在？他们是一无尊重二缺薪水的屌丝。

结果，设计局和工程院找不到合格的新工程师。有些大学毕业会来，然后不得不走人，因为他们得养家糊口。坦克工程师现在平均年龄：55-60。

https://zhuanlan.zhihu.com/p/507112662

制裁怎样干掉俄罗斯(上)

https://zhuanlan.zhihu.com/p/507342713

制裁怎样干掉俄罗斯(下)

---

在西方，它有时直译成《孙子兵法》，但更多的时候，它有另一个更传奇的书名——《战争的艺术》。

https://www.sohu.com/a/548858845_374379

乌军掩体里的这个发现，与中国软实力有关！

https://www.zhihu.com/question/533626266

俄方在亚速钢铁厂内发现乌军遗留的《孙子兵法》，这本书有哪些军事价值？它为何能够留存至今仍被人追捧？

---

《共青团真理报》的记者找到了普京当年上学时候的学生手册，上面清楚地记录着，普京上课时不遵守纪律，不交家庭作业，因而遭到老师的训斥。手册还显示，普京那学期的学习成绩很糟糕，在苏联时代的5分制学习成绩中，他的算术和自然课只得了3分，而绘画更是只拿了2分。

https://www.zhihu.com/answer/2496149307

俄罗斯为什么拿不下乌克兰？

---

买家秀 VS 卖家秀

![](/images/img4/t.jpg)

![](/images/img4/t_2.jpg)

![](/images/img4/t_3.jpg)

![](/images/img4/t_4.jpg)

![](/images/img4/t_5.jpg)

---

![](/images/img4/battle.jpg)

利沃夫大饺子，第聂伯罗中饺子，顿巴斯小饺子，北顿千里香馄炖

---

俄军把在俄罗斯务工的，具有服役经历的中亚人动员起来了，威胁他们如果不当兵就注销国籍。

苏25是第比利斯产的，毛子有没有能力重开苏25生产线都不好说。。。

---

要是毛子真的搞到了两门完整的凯撒，只有一个可能性，那就是这两门炮，搞不好是被乌军给私下里卖给了毛子或者顿涅茨克人了。

这种事情在冲突爆发前也不是没有，炮55旅和炮26旅都出过在撤离现地时，把炮弹甚至榴弹炮卖给顿巴斯民兵这种烂活。冲突爆发后，赫尔松方向的乌军甚至还搞出过卖BTR附赠一枚标枪这种事情。所以假设这是真的，那只能说明乌克兰军队已经彻底没救了。

---

里面扒出来报关单，噗精总统的一个马桶刷和厕纸架子就能有十五万卢布，足够骗一个短期合同饼大叔干一个月……要说破防，看到这个才让人破防，秋明的五十岁大叔为了给儿挣娶媳妇钱，跑到前线参加噗精发动的战争拿命换钱，换来的钱也只够噗精团伙几个或许永远都用不上的马桶刷。

---

斯洛伐克前两天把mig29捐了，然后请捷克空军来防守领空。。。

捷克斯洛伐克：如闪电般归来

---

7月9日，俄军放出了一段视频，视频显示俄军正在使用OTR-21，即圆点-U弹道导弹打击乌军目标。视频存活的时间非常短，不到数分钟就被俄罗斯人撤下，因为他们突然想起来，自己在几个月前否认了还有圆点-U这一导弹的库存！如果大家忘记了，我想提醒各位的是，4月8日，俄军使用圆点-U攻击了乌占区的克拉玛托尔斯克火车站（关于乌占区很好例证，因为这地方是乌军纵深现在还在乌克兰手里），造成了大量平民伤亡。事后发现自己的所作所为过于反人类之后，俄军立刻“官宣”自己早已淘汰了所有的圆点-U，这导弹是乌克兰人打的！

---

俄罗斯士兵吃了他们后勤贪污之后的产物:过期肉罐头，中毒了，然后俄罗斯新闻发言人，以此来污蔑乌克兰用肉毒杆菌当化学武器——肉毒杆菌，一种不具备传播性，制备极其困难，储存需要全程封闭冷链，同体积价格比黄金还贵（因为合理使用有美容功效）的厌氧性菌……

https://www.zhihu.com/question/549312883

如何看待俄罗斯国防部20日说，乌克兰对位于扎波罗热州的俄罗斯军人使用了B型肉毒杆菌毒素?

---

在俄宣中，乌克兰处于一个既强大又虚弱的叠加态，

前线军事目标爆炸

乌克兰：我做的。俄罗斯：不！你没有，是烟头。

首都附近汽车炸弹

俄罗斯民间武装：我做的。俄罗斯：不！你没有，责任都在乌方。

---

很多人穿着运动鞋羽绒服领了把破AK就上前线了，包括著名的好莱坞配音演员帕沙李，他本人在伊尔平战死。
