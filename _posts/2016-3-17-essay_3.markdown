---
layout: post
title: 一元三次方程求根公式的恩恩怨怨
category: essay 
---

# 一元三次方程求根公式的恩恩怨怨

一元三次方程的求根公式，算的上是16世纪上半叶最重要的数学发现。我对它最初认识来源于下面这篇文章。

> ## 数学史上一大冤案    
> 中世纪的意大利，盛行在街头打数学擂台，数学斗士们各向对手交一批数量不等的难题，谁先作出正确的解答，谁就是优胜者。    
> 尼古拉·塔尔达利亚便是其中的佼佼者，享有“不可战胜者”盛誉。一次，大富豪费奥里向一位教师要到了三次方程的秘密解法，向塔提出挑战，塔尔达利亚为赢得这次胜利，闭门谢客，苦苦琢磨，终于找到了三次方程的新解法，并在随后的比赛中又一次轻取桂冠。    
> 这时，一个名叫卡尔丹诺的科学骗子找到塔尔达利亚，狂妄地自称他有四万项发明，只有三次方程式才是他唯一的不解之迷，并为此痛不欲生。在卡尔丹诺甜言蜜语的哄骗下，诚实而善良的塔尔达利亚便毫无保留地将自己的新发现告诉了他。    
> 几天后，卡尔丹诺发表了一篇论文阐述三次方程式新解法，大言不惭地宣称，这是他的最新发现。塔尔达利亚被激怒了，他向卡尔丹诺提出挑战，并把骗子派来的数学高手击得惨败。然而，在一个没有星光的夜晚，塔尔达利亚被骗子收买的亡命之徒秘密刺杀了。    
> 塔尔达利亚消逝了，他对三次方程式新解法的卓越贡献也被一笔抹煞，以致在今天的不少数学著作中，他的发现仍被称为“卡尔丹诺公式”。    
> ——资料来源：《羊城晚报》1986年11月20日第三版

这个故事的情节怎么样？励志的主角，阴险的敌人，是不是很有武侠小说中的江湖气息？然而，真实的情况是怎样的呢？

## Round 1

首先，费奥里(Antonio Fiore)是不是富豪，无从考证，但他本人绝不是如阿凡提故事中的巴依老爷之类的弱智土财主。他的老师，有名的数学家Scipione del Ferro(1465–1526)，发现了形如$$x^3+mx=n$$，这样一类特殊方程的求根公式，但他秘而不宣，直到临死的时候，才将方法告诉了他的得意弟子Fiore。这种藏私的传统，虽然是当时的普遍做法，但却是后面所有纷争的起点和根源。

江山代有人才出，过了几年，到了1530年的时候，一个叫尼古拉·塔尔达利亚（Niccolò Tartaglia,1499-1557）的人，声称自己找到了一元三次方程的一般求根公式。这自然引起了Fiore的注意。于是，一场决斗开始了。

Tartaglia顺利的解出了对手的问题。而Fiore却只解出了部分问题，另外一部分形如$$x^3+mx^2=n$$的方程，显然超出了Ferro方法的范围，因此，Fiore解不出来了。

**Round 1:Tartaglia Win.**

## Round 2

接下来，卡尔丹诺同志（Gerolamo Cardano,1501-1576）出场了。1539年，在Cardano的恳求下，Tartaglia将自己的发现告诉了前者，但同时附加了一个条件：Cardano不能将该发现公开，而要给出足够的时间，以便Tartaglia自己发表该发现，从而获得相关的荣誉。

时间一晃就到了1545年，Tartaglia仍然没有发表该发现的迹象。Cardano等不及了，他的著作《Ars Magna》亟待出版。这本书是那个时代，代数学的集大成之作。Cardano不仅给出了一元三次方程的求根公式，还首次指出了重根的存在。其中最大的贡献是给出了虚数的定义，这可是非常超前的概念，要知道那个时代，连负数都没有被科学界普遍认可。当然，这时的虚数，仅仅是Cardano的一种数学技巧，就连Cardano本人也不认为它们是真实的数。只有到了欧拉的时代，才真正给虚数找到了它存在的意义。

为了遵守和Tartaglia的约定，Cardano从Ferro方法出发，给出了另一种有别于Tartaglia的推导过程，而且他在书中提到，这是在Tartaglia的启发下作出的。但这种回避方法，显然不能被Tartaglia所接受。于是，新的决斗开始了。

代替Cardano出战的，是他的仆人兼学生Lodovico Ferrari(1522–1565)。Ferrari是那个时代最天才的数学家，他不仅掌握了一元三次方程求根公式，还在此基础上，研究出了一元四次方程求根公式。于是，这场决斗的结果也就不难猜测了，Tartaglia完败。

**Round 2:Tartaglia Loss.**

经此一役，Cardano奠定了他的江湖地位，数学界将他给出的一元三次方程求根公式，称为Cardano公式。看起来Tartaglia有点冤，但其实也不冤。Cardano不仅是一元三次方程求根公式的首个公开发表者，而且从《Ars Magna》所体现的数学思想上，也明显超过同时期的其他数学家。

刺客的说法，更是荒唐。Tartaglia可不是街头混混那样的底层人士，他当过出版商、城堡建筑师和土地测量员，怎么说也是社会上层人士，哪是Cardano想杀就能杀的。Tartaglia在决斗失败之后，也并没有继续纠缠下去，直接愿赌服输了。

反倒是决斗的胜利者Ferrari结局不太好，传闻他是被他的姐姐谋害的，死时年仅42岁。这会不会就是《羊城晚报》上那个骇人听闻故事的源头？

PS：以上内容，均出自维基百科的相关词条。

本来以为一元三次方程求根公式的恩怨到此为止了，没想到在最近这些年，又出了新的变故。

1989年，一个叫范盛金的人，改良了Cardano公式，创制了以自己名字命名的“盛金公式”。

2012年，另一个叫谢国芳的人，也改良了Cardano公式，是为“谢国芳公式”。

然后就热闹了，双方以以下帖子为战场，展开了大论战：

http://bbs.sciencenet.cn/thread-1125144-1-1.html

http://bbs.cnool.net/cthread-103961152.html

http://bbs.sciencenet.cn/thread-42507-1-3.html

http://bbs.sciencenet.cn/thread-8658-1-1.html

从上面的论述，大概可以看出：

1.谢国芳公式对于复数域处理的较好，谢的回复也算是言之有物的。但是否是最优，或比盛金公式强，实际上很难说。

2.盛金公式形式上比较繁琐，竟然有9种情况需要讨论，且只能处理实系数。而范盛金的回复，词汇极度贫乏，只会翻来覆去的说“胡说八道”。

3.由于这两个公式，都脱胎于Cardano公式，因此几乎无法避免形式上的类似之处。诸如“剽窃抄袭”之类的口水仗，打得没完没了。终于有个网友看不下去了，提出了“鲍赫公式”。这显然有恶搞的成分：你们抄Cardano公式，还吵得这么NB，我也抄一把献献丑。

4.最后，一个叫孙克纯的人出现了。他的言论如下：

http://wenku.baidu.com/view/abe9560c71fe910ef02df815.html

## 附：各算法的计算复杂度分析

卡尔丹诺公式

| 名称 | 加减法 | 乘法 | 除法 | 根号 |
|:--:|:--:|:--:|:--:|:--:|
| p | 1 | 5 | 1 | 0 |
| q | 2 | 9 | 1 | 0 |
| 判别式 | 1 | 5 | 0 | 0 |
| a | 1 | 1 | 0 | 2 |
| b | 1 | 0 | 0 | 1 |
| X1 | 2 | 1 | 1 | 0 |
| X2 | 2 | 2 | 0 | 0 |
| X3 | 1 | 0 | 0 | 0 |
| 总计 | 11 | 23 | 3 | 3 |

谢国芳公式

| 名称 | 加减法 | 乘法 | 除法 | 根号 |
|:--:|:--:|:--:|:--:|:--:|
| D | 1 | 3 | 0 | 0 |
| x | 2 | 12 | 1 | 1 |
| k | 2 | 1 | 0 | 2 |
| X1 | 2 | 1 | 2 | 0 |
| X2 | 1 | 3 | 0 | 0 |
| X3 | 1 | 0 | 0 | 0 |
| 总计 | 9 | 20 | 3 | 3 |

盛金公式

| 名称 | 加减法 | 乘法 | 除法 | 根号 |
|:--:|:--:|:--:|:--:|:--:|
| 判别式A | 1 | 3 | 0 | 0 |
| 判别式B | 1 | 3 | 0 | 0 |
| 判别式C | 1 | 3 | 0 | 0 |
| 总判别式 | 1 | 3 | 0 | 0 |
| Y1 | 2 | 3 | 0 | 1 |
| Y2 | 2 | 1 | 0 | 0 |
| X1 | 3 | 1 | 1 | 2 |
| X2 | 2 | 3 | 0 | 0 |
| X3 | 1 | 0 | 0 | 0 |
| 总计 | 14 | 20 | 1 | 3 |

鲍赫公式

| 名称 | 加减法 | 乘法 | 除法 | 根号 |
|:--:|:--:|:--:|:--:|:--:|
| 标准型转换 | 0 | 0 | 3 | 0 |
| p | 1 | 0 | 0 | 1 |
| q | 1 | 0 | 0 | 1 |
| m | 2 | 6 | 0 | 0 |
| n | 2 | 6 | 0 | 1 |
| X1 | 2 | 2 | 0 | 0 |
| X2 | 5 | 3 | 0 | 0 |
| X3 | 1 | 0 | 0 | 0 |
| 总计 | 14 | 17 | 3 | 3 |

注：

1.不考虑方程的特殊情况，因为那种情况下，计算量明显少于正常情况。

2.常数项的计算量为0，比如3的平方根，这个完全可以事先计算好，而不必占用真正的计算时间。类似的还有圆周率，恐怕没有谁用的时候，还要套公式去计算一遍吧，一般选用适当的精度即可。

3.假设计算可用的内存无限多，也就是任意中间结果都可以被保存下来，而不必重新计算。

结论：

1.从计算机计算的时间来看，加减法最简单，一般1个指令周期就可完成。乘法需要3~4个指令周期，除法一般要10个指令周期，根式更多一些，一般要15个指令周期，三角函数和根式差不多，反三角函数最慢，需要20~30个周期。以上均为采用目前IC领域比较公认的Cordic算法时的情况。

2.所有的公式，都有3次根式计算，所以这一项平手。

3.谢国芳公式虽然看起来比盛金公式简洁（少了5次加减法），但多了2次除法，速度上是不如盛金公式的。

4.XYZ34的公式，使用了三角函数和反三角函数，速度上根本不具有可比性，故不列出。

# 镇楼之宝

![](/images/article/nb.png)

# 世说新语

## 2016.11

日心说这个东西，现在的人总觉得古人脑子怎么不开窍，老以自己为中心，而没有想到地球围绕太阳转。

其实日心说，古代就有。之所以不流行，是因为遇到了托勒密这个大牛，这哥们对球面几何和三角函数都研究的很深，发明了最早的三角函数表。

托勒密的著作中不但建立了地心说模型，而且还有数学推导。这也使得他的反对者长期以来，搞不定他。

就是哥白尼，其实也没有能翻案。真正搞定托勒密，要等到开普勒时代了。

----

光速不变的历史要点：

1.莫雷-迈克尔孙干涉实验表明光速不变。

2.洛伦兹认为既然速度不变，那就是距离和时间变了。

3.爱因斯坦在此基础上导出狭义相对论和原子弹理论。

4.群众表示不服，你丫的理论的idea是洛伦兹的。

5.爱因斯坦：我要放大招，看我的广义相对论。

6.群众表示：看不懂。。。

7.爱因斯坦：这就对了。

## 2017.1

岁首，业界最重要的事情莫过于AlphaGo以Master之名再度出山，60场快棋未遇敌手。牛逼！

http://goeye-app.com/resources.html#cn

精选在线棋谱资源

## 2017.2

![](/images/article/nuclear.png)

天地人材，当为天地惜之。朝廷名器，当为朝廷守之。天下万世是非公论，当与天地万世共之。——范景文

国家到了如此地步，除我等为其死，毫无其他办法。更相信，只要我等能本此决心，我们国家及我五千年历史之民族，决不至亡于区区三岛倭奴之手。为国家民族死之决心，海不清，石不烂，决不半点改变。——张自忠
