---
layout: post
title:  Hbase
category: AI 
---

# Hbase

官网：

http://hbase.apache.org/

快速开始：

http://hbase.apache.org/book.html#quickstart

启动脚本：

1.HDFS

`sbin/start-dfs.sh`

2.Hbase

`bin/start-hbase.sh`

参考：

http://www.cnblogs.com/cenyuhai/

这个blog专注于hadoop、hbase、spark。

http://www.cnblogs.com/nexiyi/p/hbase_shell.html

HBase的常用Shell命令

http://www.cnblogs.com/Dreama/articles/2219190.html

Hadoop+HBase伪分布式安装配置

https://sourceforge.net/projects/haredbhbaseclie/

HareDB HBase Client是一个Hbase的Web GUI客户端，比较好用。

## 基本概念

HBase以表的形式存储数据。表有行和列组成。列划分为若干个列族/列簇(column family)。

<table>
<tr>
<td rowspan="2"><strong>Row Key</strong></td>
<td colspan="2"><strong>column-family1</strong></td>
<td colspan="3"><strong>column-family2</strong></td>
<td><strong>column-family3</strong></td></tr>
<tr>
<td><strong>column1</strong></td>
<td><strong>column2</strong></td>
<td><strong>column1</strong></td>
<td><strong>column2</strong></td>
<td><strong>column3</strong></td>
<td><strong>column1</strong></td></tr>
<tr>
<td><strong>key1</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>
<tr>
<td><strong>key2</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr>
<tr>
<td><strong>key3</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td></tr></table>

如上图所示，key1,key2,key3是三条记录的唯一的row key值，column-family1,column-family2,column-family3是三个列族，每个列族下又包括几列。比如，column-family1这个列族下包括两列，名字是column1和column2。

HBase中，将一个Column Family中的列存在一起，而不同Column Family的数据则分开。

不要在一张表里定义太多的column family。目前Hbase并不能很好的处理超过2~3个column family的表。因为某个column family在flush的时候，它邻近的column family也会因关联效应被触发flush，最终导致系统产生更多的I/O。

吐槽一下。既然2~3个column family的表都支持的不好，那么似乎表明column family在现阶段只是一个设计的概念，离实用尚有距离。这样做的用意，大概是期待有一天Hbase把这个特性做好之后，上层应用可以无须修改吧。

参考：

https://mp.weixin.qq.com/s/ElmuT_Z2UIavFKUlSM7rZw

HBase RowKey与索引设计

## HBase架构

![](/images/article/hbase.jpg)

HBase在物理上是HDFS上的文件，因此它也是主从结构的。

## 常用的HBase Shell命令

这些命令可在hbase的控制台输入。进入控制台：

`bin/hbase shell`

| 名称 | 命令表达式 |
|:--|:--|
| 查看当前用户 | whoami |
| 创建表 | create '表名称', '列名称1','列名称2','列名称N' |
| 添加记录 | put '表名称', '行名称', '列名称:', '值' |
| 查看记录 | get '表名称', '行名称' |
| 查看表中的记录总数 | count  '表名称' |
| 删除记录 | delete  '表名' ,'行名称' , '列名称' |
| 删除一张表 | 先要禁用该表，才能对该表进行删除，第一步 disable '表名称' 第二步  drop '表名称' |
| 查看所有记录 | scan "表名称" |
| 查看某个表某个列中所有数据 | scan "表名称" , ['列名称:'] |
| 更新记录 | 就是重写一遍进行覆盖 |

## 二级索引

原生态的HBase由于是按列存储的key-value对，原则上只能通过key查询value，因此无法创建主键之外的索引。然而，二级索引在当前的数据应用中，已经相当普遍了。如何解决这一问题呢？

**方法一**：将需要创建键的若干列的内容放到key中。比如，某数据表需要对日期和地点建索引，则key的值可以写成“2017-北京”这样的形式。

这个方法的缺点在于，放入key中的列相当于是行存储结构，会降低查询效率。设想一下，如果所有列都放到key中，那么实际上这个数据表就退化成了普通的按行存储的关系数据库了。

一般来说，采用方法一的数据表其key中包含的列数不应超过10个。

**方法二**：外挂二级索引库。目前主要实现的方案有ITHBase，IHBase，CCIndex，华为二级索引和360二级索引等。这些方案的实现细节虽有差异，但原理上都差不多，即：在数据本身之外，创建专门的数据结构用于存放二级索引。

细节可参考：

http://blog.csdn.net/dhtx_wzgl/article/details/49423979

HBase学习之二级索引

## OpenTSDB

OpenTSDB（Time Series Database）是一个基于HBase的存放时序数据的数据库。

官网：

http://opentsdb.net/

DB这个词很有误导性，其实它并不是一个db，单独一个OpenTSDB无法存储任何数据，它只是一层数据读写的服务，更准确的说它只是建立在Hbase上的一层数据读写的服务。

HBase在使用上的一个难点就是如何根据业务的特点，设计键值和索引。OpenTSDB就是这方面的一个实践。

参考：

https://mp.weixin.qq.com/s/GApmeXGbjRTnhullArlkYg

小米正用时序数据库，解决这个“硬核”问题

## 参考

https://mp.weixin.qq.com/s/ucQgmb1NkdyfAw6wDTyWYg

阿里HBase又放出了哪些大招？

https://mp.weixin.qq.com/s/BICJgyv2Y8r0j5Jjw6weRw

大数据查询——HBase读写设计与实践

https://blog.csdn.net/odailidong/article/details/41794403

Hbase万亿级存储性能优化总结

https://mp.weixin.qq.com/s/kJbeuu3zqRxQxVN38Z4asA

​你应该知道的HBase基础，都在这儿了

https://mp.weixin.qq.com/s/Bl1NT-pgSseImLEd9f6xzA

Apache HBase的现状和发展

https://mp.weixin.qq.com/s/xWNSI9jZVIYaGxdBsSB8gw

快手HBase在千亿级用户特征数据分析中的应用与实践

https://mp.weixin.qq.com/s/pQbsGxM59fgQMYH54ETk7Q

面试集锦-HBase

https://mp.weixin.qq.com/s/vyF0VAF8xjEWrBnS1_DtkA

用HBase做高性能键值查询？

# 世说新语+

## 2019.11（续）

https://zhuanlan.zhihu.com/p/92515874

方舟子: P图技术谁最高？中国院士曹雪涛

https://news.ifeng.com/c/7rjYqMdUTaK

“美国方舟子”、PS杀手，举报南开校长的她究竟何许人也？

https://new.qq.com/omn/20191118/20191118A0LULL00.html

一个科研狗对“南开校长曹院士论文造假事件”的完全剖析

https://zhuanlan.zhihu.com/p/92387410

Elisabeth M Bik质疑曹雪涛论文图片复用等不端行为的更新记录

https://zhuanlan.zhihu.com/p/92940106

“南开大学校长曹雪涛院士涉嫌论文数据造假事件”相关推文收录

----

https://zhuanlan.zhihu.com/p/71806405

从全国冠军到av女优，现在又重回冠军？这是什么传奇人生

今井梦露，车牌号：KIDM–516

----

西南联大时期，北大文科研究所在西南联大内部恢复。著名史学家傅斯年担任北大文科研究所所长，另一位史学家、教育学家郑天挺任副所长。于是乎，有人来访时,北大文科研究所的接待人员总是先问：“你找傅所长还是郑所长?傅所长是正所长，郑所长是副所长。”

----

租鸡青一: 意思是租房找鸡是当代大陆青年的唯一出路。

----

https://mp.weixin.qq.com/s/e5jjAXqaCFD7jYps1YIGqw

真科技向善！全网黑客，都在帮一个脑瘫女孩破解软件！

----

国民党军把陈官庄所有的树木砍伐一空，又挨家挨户搜集木材，搭建碉堡，门板、床板、棺材也被挖走制作掩体。他们将方圆数里的家禽甚至牲口全部宰杀，民房全部强占，百姓的家具和锅碗瓢盆被扔得到处都是，柴垛、草堆等燃料也都被付之一炬。

村里的粮食很快就被他们抢光吃完了，被围困的数十万国民党军官兵只有靠空投物资苟延残喘。陈官庄设有两个空投场，刚开始，投送的是大米和面粉，然而他们一来就把柴草烧光了，飞机只能改投大饼、饼干、罐头等熟食。

后来大雪不断，空投次数减少。国民党阵地物价飞涨，物资被军官们把控。军官们把大饼和香烟高价售卖给士兵，一块银元一开始还能买包烟，后来只能买到一根烟，五块银元才能买到一张大饼。军官把小麦磨成面粉吃掉，把盛夏的麦麸制成半生不熟的饼卖给士兵，曾有一个奄奄一息的工兵用一个金戒指从长官手里换了两个麦麸饼。

----

“高陶事件”：高宗武、陶希圣在抗日战争初期追随汪精卫鼓吹“和平”运动，并于1938年随汪精卫出逃河内，其后又参与了筹组汪伪政权，以及与日本人的所谓“和平”谈判。在谈判过程中，高、陶二人逐渐认识到日本人的最终目的是企图灭亡中国、汪精卫的所谓“和平”运动就是彻底的投降与卖国。于是，在1940年1月3日，高、陶二人同逃离上海，抵达香港，并以二人名义在香港《大公报》揭露汪日密约《日支新关系调整要纲》及其附件。以自己的行动揭露了日本帝国主义的诱降政策。

高宗武在美剧《高堡奇人》中，成为了中国总统。。。

----

https://zhuanlan.zhihu.com/p/28517736

百货大楼20秒塌为平地，贪得无厌导致1500人遭活埋（韩国三丰百货店倒塌灾难）

## 2019.12

https://mp.weixin.qq.com/s/GewL2uy-G5sEez67FjPeBg

高以翔和上海滩往事

----

https://www.zhihu.com/question/285058234

永暑岛怎么会发现淡水资源？（淡水透镜体效应）

----

https://mp.weixin.qq.com/s/OsRH4uspHHHV88_xvbJB5w

北京猿人发现90周年：它曾轰动世界，后遭战争厄运，如今下落成谜
