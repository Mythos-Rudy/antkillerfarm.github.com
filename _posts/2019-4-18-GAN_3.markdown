---
layout: post
title:  GAN（三）——Pix2Pix, CycleGAN, 参考资源（1）
category: GAN & VAE 
---

# BEGAN & EBGAN（续）

对于原始的GAN来说，G网络和Decoder的结构类似，而D网络和Encoder的结构类似。所以整个网络D(G(z))就像是一个反着接的AutoEncoder。

AutoEncoder：Encoder->Decoder

GAN：Decoder->Encoder

对于生成模型来说，细节是很重要的，然而原始的GAN，通常只能生成模糊的图片。如何提高图片的分辨率呢？

BEGAN将D网络的结构由Encoder改为了Encoder->Decoder（也就是一个AE），即输入和输出都是图片。将Loss由KL散度改为了MSE。

这样的做法可以类比CV中的分类网络和语义分割网络。由于Loss和图片的每个像素都直接相关，因此更利于生成细节信息。

类似的，这里的AE，也可以换成其他Encoder->Decoder网络，例如U-NET。

影响GAN性能的还有一个问题：**mode collapse(模式坍塌)**，即生成高度相似的样本。分类网络由于样本/类别是多对一的关系，更容易发生模式坍塌。

![](/images/img2/mode_collapse.jpg)

假设某个data distribution有两个模式（如上图所示），generator可能就学到一个mode，另一个mode则完全没学到。

# Pix2Pix

论文：

《Image-to-image translation with conditional adversarial networks》

代码：

https://github.com/phillipi/pix2pix

torch版本

https://github.com/affinelayer/pix2pix-tensorflow

tensorflow版本

https://github.com/williamFalcon/pix2pix-keras

keras版本

![](/images/img2/pix2pix.png)

Pix2Pix对于user control的要求比一般的CGAN更高，这里的监督信息不再是一个类别，而是一张图片。上图就是一个使用Pix2Pix对素描图上色的示例。其中的素描图就相当于CGAN中的类别信息。

Pix2Pix相对于传统GAN的改进在于：

**1.D网络的输入同时包括生成的图片X和它的素描图Y，X和Y使用Concat操作进行融合。**例如，假设两者都是3通道的RGB颜色图，则D网络的Input就是一个6通道的tensor。

**2.G网络使用dropout来提供随机性。**作者在实践中发现，噪声向量在这个模型的学习过程中，被模型忽略掉了，起不到相应的作用。

**3.G网络使用U-NET。**实践表明，U-NET比AE的效果要好。

**4.L1损失函数的加入来保证输入和输出之间的一致性。**

**5.使用PatchGAN来保证局部精准。**

一般的GAN的D网络，只需要输出一个true or fasle的矢量，这代表对整张图像的评价。而PatchGAN输出的是一个NxN的矩阵，这个NxN的矩阵的每一个元素，对应着原图中的一个Patch。

![](/images/img3/Patch_GAN.png)

判别器对每一个patch做真假判别，将一张图片所有patch的结果取平均作为最终的判别器输出。这一步在具体实现上，就是使用Conv来代替D网络最后一层的FC。由于Conv操作不在乎输入尺寸，因此可以用不同尺寸的图片训练网络。

![](/images/img3/Patch_GAN_2.png)

这是使用不同大小的patch的效果。可以看出patch size越大，则效果越好，但是计算量也越大。

参考：

https://blog.csdn.net/stdcoutzyx/article/details/78820728

Pix2Pix-基于GAN的图像翻译

https://zhuanlan.zhihu.com/p/38411618

pix2pix

https://www.jianshu.com/p/8c7a7cb7198c

pix2pix

https://blog.csdn.net/gdymind/article/details/82696481

一文读懂GAN, pix2pix, CycleGAN和pix2pixHD

https://mp.weixin.qq.com/s/_PlISSOaowgvVW5msa7GlQ

条件GAN高分辨率图像合成与语义编辑pix2pixHD

https://mp.weixin.qq.com/s/PoSA6JXYE_OexEoJYzaX4A

利用条件GANs的pix2pix进化版：高分辨率图像合成和语义操作

https://blog.csdn.net/xiaoxifei/article/details/86506955

关于PatchGAN的理解

# CycleGAN

Style Transfer的基本内容可参见《深度学习（十五）》。

除了基于纹理的Style Transfer之外，基于GAN的Style Transfer是另外一个流派。

论文：

《Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks》

![](/images/img3/CycleGAN.png)

![](/images/img3/CycleGAN_2.png)

![](/images/img3/CycleGAN_3.png)

参考：

https://zhuanlan.zhihu.com/p/28342644

CycleGAN的原理与实验详解

https://mp.weixin.qq.com/s/7GHBH79kWIpEBLYX-VEd7A

CycleGAN：图片风格，想换就换

https://mp.weixin.qq.com/s/sxa0BfXtylHXzjq0YBn-Kg

伯克利图像迁移cycleGAN，猫狗互换效果感人

https://mp.weixin.qq.com/s/tzPCU1bxQ7NWtQ7o2PjF0g

BAIR提出MC-GAN，使用GAN实现字体风格迁移

https://mp.weixin.qq.com/s/A2VhfO3CkyQGCs5GqBWzOg

实景照片秒变新海诚风格漫画：清华大学提出CartoonGAN

https://mp.weixin.qq.com/s/rt4uuqh8IrZTjsYXEZvxKQ

阿里提出全新风格化自编码GAN，图像生成更逼真！

https://mp.weixin.qq.com/s/3lrCRiq5zuX9yWxiQRQE9A

CartoonGAN不靠手绘，也能成为漫画达人

https://mp.weixin.qq.com/s/i3lNcbOblgVKUTBtwKIFwg

AI秒造全球房源：StyleGAN快速生成假房子，连图说都配好了！

# Stack GAN

论文：

《StackGAN: Text to Photo-realistic Image Synthesis with Stacked Generative Adversarial Networks》

![](/images/img2/Stack_GAN.png)

上图是Stack GAN的网络结构图。其中的Conditioning Augmentation，显然使用了和VAE类似的技术。

类似想法的还有LAPGAN。

论文：

《Deep Generative Image Models using a Laplacian Pyramid of Adversarial Networks》

顾名思义，这是使用了Laplacian Pyramid来不断提升生成图片的分辨率。

参考：

https://www.cnblogs.com/wangxiaocvpr/p/5966776.html

LAPGAN论文笔记

# 参考资源

https://blog.csdn.net/liuxiao214/article/category/6940697

某GAN专栏

https://mp.weixin.qq.com/s/oCDlhzjOYTIhsr5JuoRCJQ

IRGAN：大一统信息检索模型的博弈竞争

https://mp.weixin.qq.com/s/4Daw-2aRmzcCMtxdvB3uYQ

IRGAN：生成对抗网络在搜狗图片搜索排序中的应用

https://zhuanlan.zhihu.com/p/30532830

眼见已不为实，迄今最真实的GAN：Progressive Growing of GANs

https://mp.weixin.qq.com/s/PkZ069S8ysY_JCQx1nzfGg

NVIDIA新作解读：用GAN生成前所未有的高清图像（附PyTorch复现）

https://mp.weixin.qq.com/s/Q_1IUS-65ZAFt9w0RlZUpw

谷歌开源TFGAN：轻量级生成对抗网络工具库

https://mp.weixin.qq.com/s/E28lA-fcAQ6Sp6Qv64H3TQ

GAN in NLP

https://mp.weixin.qq.com/s/7-oHa-8Q8ThcctaVOZFfew

Facebook创意生成网络CAN，比GAN更有创造力

https://mp.weixin.qq.com/s/aSQ2-QxbToGF0ROyjxw2yw

萌物生成器：如何使用四种GAN制造猫图

http://mp.weixin.qq.com/s/UkZdUcdz7h4DqcyjSbNncw

zi2zi：用条件生成对抗网络玩转中文书法，绝妙汉字字体自动生成

http://blog.csdn.net/v_JULY_v/article/details/52683959

没GPU也能玩梵高作画：Ubuntu tensorflow CPU版

http://mp.weixin.qq.com/s/zNmJuevHaagKbyGFdKTwoQ

tensorflow实现基于深度学习的图像补全

https://zhuanlan.zhihu.com/p/27199954

用GAN去除动作片中的马赛克和衣服

https://mp.weixin.qq.com/s/Qzlg1MzRT3josy2RJpQSVg

Image to Image Translation Using GAN

https://mp.weixin.qq.com/s/AswdyjPeKbX7yhAPloP2og

基于对抗学习的生成式对话模型

https://mp.weixin.qq.com/s/YXWTslQXIKVihBb2Bgtafg

GAN在信息检索领域的应用

https://mp.weixin.qq.com/s/0tTLotV-8w2j3VdkH-qjCQ

让机器告诉你故事的结局应该是什么：利用GAN进行故事型常识阅读理解

https://zhuanlan.zhihu.com/p/28488946

AI可能真的要代替插画师了……

https://mp.weixin.qq.com/s/OXN8Y5truLeslX8-UWgqmg

宅男的福音：用GAN自动生成二次元萌妹子

https://mp.weixin.qq.com/s/NFqTpSXtFdP43MBeb3Ovrw

GAN眼中的图像翻译

http://blog.csdn.net/amds123/article/details/70199708

生成对抗网络GAN最近在NLP领域有哪些应用？

https://mp.weixin.qq.com/s/h7lrJYQ_RqJDako8UoYK-A

六种改进均未超越原版：谷歌新研究对GAN现状提出质疑

https://mp.weixin.qq.com/s/dwEHorYSJuX9JapIYLHiXg

BicycleGAN：图像转换多样化，大幅提升pix2pix生成图像效果

https://mp.weixin.qq.com/s/W4WVHMIMKPNvt5lcCe1v4g

半监督学习需要Bad GAN，清华特奖学霸与苹果AI总监提出

https://mp.weixin.qq.com/s/jG7r7THhVAnJTYgDeWX2Eg

百度提出使用GAN构建语音识别新框架

https://mp.weixin.qq.com/s/I7axl00VZeCHJpaaITCO2Q

对抗学习GAN提升跨模态检索效果

https://mp.weixin.qq.com/s/OZWih_xfqYdeP-x9MawogA

GAN做图像翻译的一点总结

https://zhuanlan.zhihu.com/p/32103958

GAN调研：多极扩展（跨域和条件的GAN扩展模型调研）

https://mp.weixin.qq.com/s/RZ6UbTgfn30UFaUYNtApRg

如何用Masking GAN让100,000人笑起来？

https://mp.weixin.qq.com/s/OPn4_jmJ7pUg8xa0FZvyiw

超火的漫画线稿上色AI出新版了！无监督训练，效果更美好

https://mp.weixin.qq.com/s/wrxKwY2SvJZc8bRuZ_wF_A

用生成对抗网络给雪人上色，探索人工智能时代的美学

https://mp.weixin.qq.com/s/lPeySqEr3pzPdZqnp1Eh8A

CMU提出对抗生成网络：可实现对人脸识别模型的神经网络攻击

https://mp.weixin.qq.com/s/f5dGUJw3bv8WppPZVzqyAA

反GAN传统，Petuum自动驾驶新研究提出从复杂真实图像生成简单虚拟表征以预测驾驶指令

https://mp.weixin.qq.com/s/SvIC6DXUKH93jU9R-7fcyw

CNN对抗补丁之谜

https://mp.weixin.qq.com/s/V1XX8WWstR00m_OimMrDDw

微软亚洲研究院论文解读：GAN在网络特征学习中的应用

https://mp.weixin.qq.com/s/YNkx03D2Ok2xyMpPI0XXKg

Petuum新研究提出形义感知型Grad-GAN：可基于虚拟游戏生成更具真实感的城市场景

http://mp.weixin.qq.com/s/RlpI3hCKjcJ8VHSbBXf84g

用生成对抗网络解决NLP问题：谷歌大脑提出MaskGAN

https://mp.weixin.qq.com/s/gDzti2DISq_cwGbP5T7ICQ

聊聊对抗自编码器
