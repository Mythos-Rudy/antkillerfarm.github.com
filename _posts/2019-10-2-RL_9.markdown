---
layout: post
title:  强化学习（九）——博弈论（2）
category: RL 
---

* toc
{:toc}

# 博弈论

## 概述（续）

**决策**问题的三要素：

- **行动(action)**: 玩家可能的选择
- **结果(outcome)**: 每个行动的可能后果
- **倾向(preference)**: 对所有可能后果，按照从最渴望到最不渴望的排列。

**理智选择假设**：

一个玩家完全明白决策问题：

- 所有可能的行动
- 所有可能的结果
- 了解行动如何影响结果
- 玩家的理性倾向（收益）是基于结果的

**经济人(Homo economicus)**：一个经济人是理智的，了解决策问题的各个因素，并且总是选择可以获得最高收益的行动。

**风险态度**：

- 中立风险（risk neutral）：认为同样期望回报的价值相同。
- 厌恶风险（risk averse）：倾向于一个确定性的回报，不愿意采用一个拥有同样期望回报的不确定性方案。
- 喜爱风险（risk loving）：更严格地倾向于采用拥有同样期望回报的赌注。

博弈论旨在了解游戏的动态，以优化其玩家可能获得的结果。相反的，**逆博弈论（Inverse Game Theory）**旨在根据玩家的策略和目标来设计游戏。逆博弈论在多智能体AI以及人机交互AI中都很有用处。

## 囚徒困境

![](/images/img3/prisoner_dilemma.jpg)

上图是囚徒困境（prisoner's dilemma）的**策略矩阵**。

参与者为：囚徒A和囚徒B。动作空间为：{坦白、抵赖}，回报函数由矩阵给出。即：

- 当囚徒A和囚徒B都坦白时，囚徒A被判处3年有期徒刑、囚徒B也被判处3年有期徒刑。
- 当囚徒A坦白、囚徒B抵赖时，囚徒A被当场释放、囚徒B被判处5年有期徒刑。
- 当囚徒A抵赖、囚徒B坦白时，囚徒A被判处5年有期徒刑、囚徒B当场释放。
- 当囚徒A抵赖、囚徒B抵赖时，囚徒A和B都被判处1年有期徒刑。

很明显，如果两个囚徒都选择抵赖，那么它们总的惩罚最低。然而，选择抵赖对于囚徒个人来说是理性的吗？

答案是：选择抵赖对于个人来说并不理性。因为，就个人而言，囚徒并不知道另外一个囚徒选择的策略是什么。在这种情况下，选择坦白对于个人来说是理性的，而且是最优的。

即，不管其他囚徒选择什么动作，选择坦白总比选择抵赖要优。

比如，对于囚徒A来说：

当囚徒B选择坦白时，如果囚徒A选择坦白被判处3年有期徒刑；而这时如果A选择抵赖则被判处5年有期徒刑，所以这时囚徒A选择坦白要好。

当囚徒B选择抵赖时，如果囚徒A选择坦白，则当场释放；而这时如果A选择抵赖，则被判处1年有期徒刑，所以这时囚徒A选择坦白要好。

综合这两种情况，对于囚徒A不管囚徒B如何选择，选择坦白都是最好的。

在该例中（坦白，坦白）是**占优策略（dominated strategy）**。所谓占优策略是指如果一方在任何情况下从某种策略中得到的回报均大于从另外一种策略得到的回报，那么我们称为这种策略为占优策略。

囚徒困境同样适于分析寡头垄断厂商合作的不稳定性。对于寡头整体而言最理性的做法是（合作，合作）。于是，诸如OPEC等组织会联手以期达到利润最大化。但同时，另外有种激励，若自己悄悄毁约、不遵守协议自己的获利会高于合作下的获利。于是（不合作，不合作）的策略组合排挤掉了（合作，合作）的策略组合，并且由于（不合作，不合作）组合还是一个占优策略均衡，所以，卡特尔经常以失败告终，也就属情理之中了。

## 帕累托最优

帕累托最优(Pareto Optimality)，也称为帕累托效率(Pareto efficiency)，是指资源分配的一种理想状态，假定固有的一群人和可分配的资源，从一种分配状态到另一种状态的变化中，在没有使任何人境况变坏的前提下，使得至少一个人变得更好。帕累托最优状态就是不可能再有更多的帕累托改进的余地;换句话说，帕累托改进是达到帕累托最优的路径和方法。 帕累托最优是公平与效率的"理想王国"。

>Vilfredo Pareto，1848~1923，意大利经济学家、社会学家。

## 纳什均衡

Nash equilibrium的定义：

在博弈中，如果联结策略$$(\pi^*_1,\dots,\pi^*_n)$$满足：

$$V_i(\pi^*_1,\dots,\pi^*_i,\dots,\pi^*_n)\ge V_i(\pi^*_1,\dots,\pi_i,\dots,\pi^*_n),\forall \pi_i \in \Pi_i, i=1,\dots,n$$

则为一个**纳什均衡**。若上式严格大于，则为**严格纳什均衡**。

若智能体的策略对一个动作的概率分布为1，对其余的动作的概率分布为0，则这个策略为一个**纯策略**。

若一个策略对于智能体动作集中的所有动作的概率都大于0，则这个策略为一个**完全混合策略**。

介于上述两者之间的叫做**混合策略**。

纳什存在定理(Nash's existence Theorem)：

任何普通形式、具有限策略集合的博弈存在一个纳什均衡的混合策略。

**零和博弈**中，两个智能体是完全竞争对抗关系，它只有一个纳什均衡值，即使可能有很多纳什均衡策略，但是期望的奖励是相同的。

**一般和博弈**是指任何类型的矩阵博弈，包括完全对抗博弈、完全合作博弈以及二者的混合博弈。在一般和博弈中可能存在多个纳什均衡点。

下图是纳什均衡的几何解释：

![](/images/img3/Nash.png)

>John Nash，1928～2015，数学家、经济学家。Princeton博士（1950），Princeton教授。主要研究博弈论、微分几何学和偏微分方程。诺贝尔经济学奖获得者（1994）。奥斯卡金像奖电影《美丽心灵》男主角原型。

## 高风险下的纳什均衡

在一些特殊情况下，即使犯错误的可能性很小也可能导致大的灾难（比如核电站，出问题就非常严重），纳什均衡就可能不会产生有说服力的解释。考虑如下博弈：

<table>
  <tr>
    <td colspan="2" rowspan="2"></td>
    <td colspan="2" align="center">乙</td>
  </tr>
  <tr>
    <td>左</td>
    <td>右</td>
  </tr>
  <tr>
    <td rowspan="2">甲</td>
    <td>上</td>
    <td>8,10</td>
    <td>-1000,9</td>
  </tr>
  <tr>
    <td>下</td>
    <td>7,6</td>
    <td>6,5</td>
  </tr>
</table>

在这个博弈中，参与人甲会选择“下”，因为如果乙不小心（低概率）犯错误，要避免产生右上的灾难性情况。

这个例子说明，**个体可能不想我们所假设的那样完全理性，在遇到高风险的情况下，人们会考虑风险，从而使得最终结果可能偏离纳什均衡战略。**

## 智猪博弈问题

智猪博弈问题是John Nash于1950年提出的问题。

在一个猪圈里养着一头大猪和一头小猪，在猪圈的一端放有一个猪食槽，在另一端安装有一个按钮，它控制着猪食的供应量。假定：

- 猪按一下按钮，就有8单位猪食进槽，但谁按按钮就会首先付出2单位成本；
- 若大猪先到食槽，则大猪吃到7单位食物，而小猪仅能吃到1单位食物；
- 若小猪先到，则大猪和小猪各吃到4单位食物；
- 若两猪同时到，则大猪吃到5单位，小猪仅吃到3单位。

显然，在这里按按钮有两个成本：

- 直接成本：2单位成本。
- 间接成本：先按按钮的猪，肯定会最后到达食槽。

因此，这个问题写成策略矩阵，则是：

<table>
  <tr>
    <td colspan="2" rowspan="2"></td>
    <td colspan="2" align="center">小猪</td>
  </tr>
  <tr>
    <td>按</td>
    <td>等待</td>
  </tr>
  <tr>
    <td rowspan="2">大猪</td>
    <td>按</td>
    <td>3,1</td>
    <td>2,4</td>
  </tr>
  <tr>
    <td>等待</td>
    <td>7,-1</td>
    <td>0,0</td>
  </tr>
</table>

该博弈不存在占优战略均衡，因为尽管小猪有一个严格占优战略，但大猪并没有占优战略。

为了解决这个问题，Nash提出了重复剔除的占优战略均衡（iterated dominance equilibrium）。

其具体做法如下：

**Step 1**：大猪没有劣战略，策略保持不变。

**Step 2**：小猪有一个劣战略: “按”。

“按”的支付值： 1, -1

“等待”的支付值： 4, 0

**Step 3**：剔除小猪的劣战略“按”。

**Step 4**：剔除之后，大猪有一个劣战略：“等待”。

**Step 5**：剔除大猪的劣战略“等待”，剩下最后一个战略组合：

大猪：“按” + 小猪：“等待”

在小企业经营中，学会如何“搭便车”是一个精明的职业经理人最为基本的素质。在某些时候，如果能够注意等待，让其他大的企业首先开发市场，是一种明智的选择。这时候有所不为才能有所为！

## 最大最小策略

0阶理性共识：每个人都是理性的，但不知道其他人是否是理性的；

1阶理性共识：每个人是理性的，并且知道其他每个人也都是理性的，但并不知道其他人是否知道自己是理性的；

2阶理性共识：每个人是理性的，并且知道其他每个人也都是理性的，并且知道其他人知道自己是理性的，但不知道其他人是否知道自己知道其他人都是理性的。。。。。。。3阶、4阶。。。n阶依次类推。

重复剔除不仅要求每个人是理性的，而且要求每个人知道其他人都是理性的，每个人知道每个人知道每个人是理性的，如此等等，即理性是“共识”。

**优势策略均衡与纳什均衡的概念是建立在博弈者理性行为的基础上的**，任何出现的一点错误将可能使博弈者蒙受巨大的损失，因而可能有player会采取比较保守的策略。

其中一种保守的策略是最大最小策略（Maximin strategy)。

它是指博弈者所采取的策略是使自己能够获得的最小收入最大化。所谓最小收入是指采取某种策略所能获得的最小收入。

最大最小策略是一种保守的策略而不是利润最大化的策略。

很显然，博弈者往往是在信息不完全的情况下才采取最大最小策略。在信息完全的情形下，他肯定是会采取促使他利润最大化的策略。

**在囚徒困境问题中，两人都坦白是最大最小策略，而两人都抵赖则是利润最大化策略。**

最大最小均衡存在以下问题：

- “最大最小”均衡没有考虑到局中人之间在策略选择上的互动。

- 由“最大最小”方法得到的“均衡”很难说是一种“均衡”。
